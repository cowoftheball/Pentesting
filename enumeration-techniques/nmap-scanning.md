---
description: different types of nmap scans
---

# nmap scanning

### nmap -sC -sV -v \<ip address>

most used scan. -sC is for default scripts. -sV is attempting to enumerate versions for services. -v is verbose

### nmap -p- -T5 -v \<ip address>

used to scan all ports (-p-). -T5 is used for fastest speed, options are -T0 to -T5. -v is verbose mode

### nmap -oN nmap.txt \<target IP>

used to run nmap scan and output scan to nmap.txt using -oN

### This scan worked really well

nmap -sC -sV -p- -T5 -v $IP -oN nmap.txt

used to scan all ports with default scripts, version enumeration, and saved output to file



## Summary of nmap scans

## ARP Scan

```
sudo nmap -PR -sn <MACHINE_IP/24>
```

## ICMP Echo Scan

```
sudo nmap -PE -sn <MACHINE_IP/24>
```

## ICMP Timestamp Scan

```
sudo nmap -PP -sn <MACHINE_IP/24>
```

## ICMP Address Mask Scan

```
sudo nmap -PM -sn <MACHINE_IP/24>
```

## TCP SYN Ping Scan

```
sudo nmap -PS22,80,443 -sn <MACHINE_IP/30>
```

## TCP ACK Ping Scan

```
sudo nmap -PA22,80,443 -sn <MACHINE_IP/30>
```

## UDP Ping Scan

```
sudo nmap -PU53, 161,162 -sn <MACHINE_IP/30>
```

## TCP Connect Scan

`nmap -sT <ip address>`

## TCP SYN Scan

`sudo nmap -sS <ip address>`

## UDP Scan

`sudo nmap -sU <ip address>`

## Null Scan

`sudo nmap -sN <ip address>`\
sends a packet with all flags set to zero. If no response is received then nmap assumes port is either open or filtered. If a response is given then nmap assumes port is closed

## FIN scan

`sudo nmap -sF <ip address>`\
sends a packet with FIN flag set to one. Reacts similarly to null scan, no response is either port open or filtered, response is port closed

## XMAS scan

`sudo nmap -sX <ip address>`\
sends a packet with FIN, PSH, and URG flags all set to one. Again, reacts similarly to above two scans

## TCP Maimon Scan

`sudo nmap -sM <ip address>`\
sends a packet with FIN and ACK flags set to one. This scan won't work on most modern networks

## TCP ACK Scan

`sudo nmap -sA <ip address>`\
sends a packet with ACK flag set to one. This scan is useful in finding ports that aren't being blocked by a firewall. With no firewall in place this scan will see all ports scanned as unfiltered, but if a firewall is blocking ports then only ports that aren't blocked will respond

## Window Scan

`sudo nmap -sW <ip address>`\
similar to ack scan except nmap reports ports as closed instead of unfiltered

## Custom scan

`sudo nmap --scanflags <flags> <ip address>`\
used to set custom flags. \
`sudo nmap --scanflags <RSTSYNFIN> <ip address>`\
above scan sets reset, syn, and fin flags to 1





## Options

\-n\
no DNS lookup



\-R\
reverse-DNS lookup for all hosts



\-sn\
host discovery only



\-p-\
all ports



\-p1-1023\
Scan ports 1 - 1023



\-F\
scan 100 most common ports



\-r\
Scan ports in consecutive order



\-T<0-5>\
0 being the slowest, 5 being the fastest



\--max-rate 50\
rate <= 50 packets/sec



\--min-rate 15\
rate >= 15 packets/sec



\--min-parallelism 100\
at least 100 probes in parallel



\--reason\
used to get reason for why nmap listed port as open



\-S\
used to add a spoofed ip address to hide attacker ip
